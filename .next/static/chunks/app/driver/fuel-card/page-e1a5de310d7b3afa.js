(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8515],{2509:function(e,t,a){Promise.resolve().then(a.bind(a,5105))},5105:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return r}});var s=a(7437),n=a(2265),i=a(149);function r(){var e,t;let a=(0,i.e)(),[r,c]=(0,n.useState)(null),[l,d]=(0,n.useState)([]),[o,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{x(!0),m(null);let{data:{user:e}}=await a.auth.getUser();if(!e){window.location.href="/auth/login";return}let{data:t}=await a.from("fuel_card_assignments").select("fuel_card_id").eq("driver_id",e.id).is("unassigned_date",null).order("assigned_date",{ascending:!1}).limit(1).maybeSingle(),s=null==t?void 0:t.fuel_card_id;if(!s){x(!1);return}let{data:n}=await a.from("fuel_cards").select("id, card_number, card_holder_name, provider, status, current_balance").eq("id",s).single();c(n);let{data:i}=await a.from("fuel_transactions").select("id, amount, quantity, type, station, transaction_date").eq("fuel_card_id",s).order("transaction_date",{ascending:!1}).limit(20);d(null!=i?i:[]),x(!1)})()},[]),u)?(0,s.jsx)("main",{className:"max-w-3xl mx-auto p-4",children:"Loading…"}):o?(0,s.jsx)("main",{className:"max-w-3xl mx-auto p-4 text-red-600",children:o}):(0,s.jsxs)("main",{className:"max-w-3xl mx-auto p-4 space-y-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"My Fuel Card"}),!r&&(0,s.jsx)("div",{className:"card p-4",children:"No active card assigned."}),r&&(0,s.jsxs)("div",{className:"card p-4 space-y-2",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:r.provider.toUpperCase()}),(0,s.jsx)("div",{className:"text-lg font-semibold",children:r.card_holder_name}),(0,s.jsxs)("div",{className:"font-mono",children:["•••• •••• •••• ",r.card_number.slice(-4)]}),(0,s.jsxs)("div",{className:"text-sm",children:["Status: ",(0,s.jsx)("span",{className:"px-2 py-0.5 rounded bg-gray-100",children:r.status})]}),(0,s.jsxs)("div",{className:"text-sm",children:["Balance: $",null!==(t=null===(e=r.current_balance)||void 0===e?void 0:e.toFixed(2))&&void 0!==t?t:"0.00"]})]}),(0,s.jsxs)("section",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Recent Transactions"}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm border",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left p-2 border",children:"Date"}),(0,s.jsx)("th",{className:"text-left p-2 border",children:"Type"}),(0,s.jsx)("th",{className:"text-right p-2 border",children:"Amount"}),(0,s.jsx)("th",{className:"text-right p-2 border",children:"Qty"}),(0,s.jsx)("th",{className:"text-left p-2 border",children:"Station"})]})}),(0,s.jsxs)("tbody",{children:[l.map(e=>(0,s.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,s.jsx)("td",{className:"p-2 border",children:new Date(e.transaction_date).toLocaleString()}),(0,s.jsx)("td",{className:"p-2 border",children:e.type.toUpperCase()}),(0,s.jsxs)("td",{className:"p-2 border text-right",children:["$",e.amount.toFixed(2)]}),(0,s.jsx)("td",{className:"p-2 border text-right",children:e.quantity.toFixed(2)}),(0,s.jsx)("td",{className:"p-2 border",children:e.station})]},e.id)),!l.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{className:"p-2 border",colSpan:5,children:"No transactions"})})]})]})})]})]})}},149:function(e,t,a){"use strict";a.d(t,{e:function(){return i}});var s=a(1388);let n=null;function i(){if(n)return n;let e="https://awjryaofcfuhyofqfixo.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!t)throw Error("Missing Supabase envs");return n=(0,s.createBrowserClient)(e,t,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let t=e.indexOf("=");return{name:t>=0?decodeURIComponent(e.slice(0,t)):e,value:t>=0?decodeURIComponent(e.slice(t+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:t,value:a,options:s}of e){let e="".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(a));s&&(s.maxAge&&(e+="; Max-Age=".concat(s.maxAge)),s.expires&&(e+="; Expires=".concat(new Date(s.expires).toUTCString())),s.path&&(e+="; Path=".concat(s.path)),s.domain&&(e+="; Domain=".concat(s.domain)),s.sameSite&&(e+="; SameSite=".concat(s.sameSite)),s.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,2971,2117,1744],function(){return e(e.s=2509)}),_N_E=e.O()}]);