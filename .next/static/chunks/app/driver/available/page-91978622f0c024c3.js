(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3356],{2858:function(e,t,n){Promise.resolve().then(n.bind(n,9127))},9127:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var a=n(7437),i=n(2265),s=n(149);function c(){let e=(0,s.e)(),[t,n]=(0,i.useState)([]),[c,o]=(0,i.useState)(!0),[l,r]=(0,i.useState)(null),d=(0,i.useCallback)(async()=>{o(!0);let{data:t,error:a}=await e.from("consignments").select("*").eq("status","pending").order("created_at",{ascending:!1});!a&&t&&n(t),o(!1)},[e]);async function u(t){r(null);let{data:{user:n}}=await e.auth.getUser();if(!n){window.location.href="/auth/login";return}let{error:a}=await e.from("consignments").update({driver_id:n.id,status:"assigned",updated_at:new Date().toISOString()}).eq("id",t.id);a?r(a.message):(r("Consignment accepted"),d())}return(0,i.useEffect)(()=>{d()},[d]),(0,a.jsxs)("main",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,a.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Available Consignments"}),l&&(0,a.jsx)("div",{className:"text-sm text-green-600 mb-3",children:l}),c?(0,a.jsx)("div",{children:"Loading..."}):0===t.length?(0,a.jsx)("div",{className:"text-neutral-500",children:"No available consignments"}):(0,a.jsx)("ul",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("li",{className:"card p-4",children:[(0,a.jsxs)("div",{className:"font-semibold",children:[e.item_description," ",(0,a.jsxs)("span",{className:"ml-2 text-xs px-2 py-1 rounded-full bg-green-50 text-green-700",children:[e.weight," kg"]})]}),(0,a.jsxs)("div",{className:"text-sm text-neutral-600",children:["Pickup: ",e.pickup_location]}),(0,a.jsxs)("div",{className:"text-sm text-neutral-600",children:["Delivery: ",e.delivery_location]}),(0,a.jsx)("div",{className:"mt-3 flex justify-end",children:(0,a.jsx)("button",{className:"btn-primary",onClick:()=>u(e),children:"Accept"})})]},e.id))})]})}},149:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var a=n(1388);let i=null;function s(){if(i)return i;let e="https://awjryaofcfuhyofqfixo.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!t)throw Error("Missing Supabase envs");return i=(0,a.createBrowserClient)(e,t,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let t=e.indexOf("=");return{name:t>=0?decodeURIComponent(e.slice(0,t)):e,value:t>=0?decodeURIComponent(e.slice(t+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:t,value:n,options:a}of e){let e="".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n));a&&(a.maxAge&&(e+="; Max-Age=".concat(a.maxAge)),a.expires&&(e+="; Expires=".concat(new Date(a.expires).toUTCString())),a.path&&(e+="; Path=".concat(a.path)),a.domain&&(e+="; Domain=".concat(a.domain)),a.sameSite&&(e+="; SameSite=".concat(a.sameSite)),a.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,2971,2117,1744],function(){return e(e.s=2858)}),_N_E=e.O()}]);