(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4167],{3815:function(e,n,t){Promise.resolve().then(t.bind(t,2067))},2067:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return s}});var a=t(7437),i=t(2265),o=t(149);function s(){let e=(0,o.e)(),n=(0,i.useRef)(null),[t,s]=(0,i.useState)(!1),[c,l]=(0,i.useState)(null),[r,d]=(0,i.useState)(null);async function u(){var n,t;let{data:a}=await e.auth.getUser();return null!==(t=null===(n=a.user)||void 0===n?void 0:n.id)&&void 0!==t?t:null}async function m(n){var t,a,i;let o=await u();if(!o)return;let s=n.coords,c={driver_id:o,lat:s.latitude,lng:s.longitude,accuracy:s.accuracy,heading:null!==(t=s.heading)&&void 0!==t?t:void 0,speed:null!==(a=s.speed)&&void 0!==a?a:void 0,altitude:null!==(i=s.altitude)&&void 0!==i?i:void 0,timestamp:new Date(n.timestamp).toISOString(),updated_at:new Date().toISOString()};l(c),await e.from("driver_locations").upsert(c)}let p=async()=>{var e;if(d(null),!("geolocation"in navigator)){d("Geolocation not supported by this browser");return}let t=await (null===(e=navigator.permissions)||void 0===e?void 0:e.query({name:"geolocation"}).catch(()=>null));if(t&&"denied"===t.state){d("Location permission denied. Please allow location access.");return}n.current=navigator.geolocation.watchPosition(e=>{s(!0),m(e)},e=>{d(e.message),s(!1)},{enableHighAccuracy:!0,maximumAge:5e3,timeout:15e3})};return(0,i.useEffect)(()=>()=>{null!=n.current&&navigator.geolocation.clearWatch(n.current)},[]),(0,a.jsxs)("main",{className:"max-w-3xl mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Driver Live Location"}),(0,a.jsx)("div",{className:"flex gap-2 mb-4",children:t?(0,a.jsx)("button",{onClick:()=>{null!=n.current&&(navigator.geolocation.clearWatch(n.current),n.current=null),s(!1)},className:"px-3 py-2 bg-gray-600 text-white rounded",children:"Stop Sharing"}):(0,a.jsx)("button",{onClick:p,className:"px-3 py-2 bg-blue-600 text-white rounded",children:"Start Sharing"})}),r&&(0,a.jsx)("p",{className:"text-red-600",children:r}),c&&(0,a.jsxs)("div",{className:"mt-4 text-sm space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Lat:"})," ",c.lat]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Lng:"})," ",c.lng]}),null!=c.accuracy&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Accuracy:"})," ",c.accuracy," m"]}),null!=c.speed&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Speed:"})," ",c.speed," m/s"]}),null!=c.heading&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Heading:"})," ",c.heading,"\xb0"]}),c.timestamp&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Timestamp:"})," ",new Date(c.timestamp).toLocaleString()]})]}),(0,a.jsx)("p",{className:"mt-6 text-xs text-gray-600",children:"Note: location updates every few seconds while this page is open."})]})}},149:function(e,n,t){"use strict";t.d(n,{e:function(){return o}});var a=t(1388);let i=null;function o(){if(i)return i;let e="https://awjryaofcfuhyofqfixo.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!n)throw Error("Missing Supabase envs");return i=(0,a.createBrowserClient)(e,n,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let n=e.indexOf("=");return{name:n>=0?decodeURIComponent(e.slice(0,n)):e,value:n>=0?decodeURIComponent(e.slice(n+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:n,value:t,options:a}of e){let e="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t));a&&(a.maxAge&&(e+="; Max-Age=".concat(a.maxAge)),a.expires&&(e+="; Expires=".concat(new Date(a.expires).toUTCString())),a.path&&(e+="; Path=".concat(a.path)),a.domain&&(e+="; Domain=".concat(a.domain)),a.sameSite&&(e+="; SameSite=".concat(a.sameSite)),a.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,2971,2117,1744],function(){return e(e.s=3815)}),_N_E=e.O()}]);