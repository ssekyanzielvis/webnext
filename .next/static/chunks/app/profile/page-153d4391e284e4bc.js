(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4178],{70:function(e,n,a){Promise.resolve().then(a.bind(a,112))},112:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return s}});var t=a(7437),i=a(2265),l=a(149),c=a(3145),o=a(7795);function s(){let e=(0,l.e)(),[n,a]=(0,i.useState)(null),[s,u]=(0,i.useState)(!1),[m,d]=(0,i.useState)(null);async function f(){u(!0);let{error:a}=await e.from("users").upsert({id:n.id,email:n.email,full_name:n.full_name,phone:n.phone,profile_image:n.profile_image});a&&d(a.message),u(!1)}async function p(){let e=await r();if(!e)return;let t=await (0,o.D)({bucket:"profile-images",file:e,path:"".concat(n.id,"/").concat(Date.now(),"_").concat(e.name)});t&&a({...n,profile_image:t.publicUrl})}return((0,i.useEffect)(()=>{(async()=>{let{data:{user:n}}=await e.auth.getUser();if(!n){window.location.href="/auth/login";return}let{data:t}=await e.from("users").select("*").eq("id",n.id).maybeSingle();a(t||{id:n.id,email:n.email,full_name:"",phone:""})})()},[e]),n)?(0,t.jsxs)("main",{className:"max-w-xl mx-auto px-4 py-6",children:[(0,t.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Profile"}),m&&(0,t.jsx)("div",{className:"text-sm text-red-600 mb-3",children:m}),(0,t.jsxs)("div",{className:"card p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"relative w-16 h-16",children:(0,t.jsx)(c.default,{src:n.profile_image||"https://placehold.co/80x80",alt:"Profile avatar",fill:!0,className:"rounded-full object-cover",sizes:"64px"})}),(0,t.jsx)("button",{className:"px-3 py-1 rounded-md bg-neutral-100",onClick:p,children:"Change Photo"})]}),(0,t.jsx)("label",{className:"text-sm",children:"Full name"}),(0,t.jsx)("input",{className:"border rounded-md px-3 py-2",value:n.full_name||"",onChange:e=>a({...n,full_name:e.target.value})}),(0,t.jsx)("label",{className:"text-sm",children:"Phone"}),(0,t.jsx)("input",{className:"border rounded-md px-3 py-2",value:n.phone||"",onChange:e=>a({...n,phone:e.target.value})}),(0,t.jsx)("button",{className:"btn-primary",onClick:f,disabled:s,children:s?"Saving...":"Save"})]})]}):(0,t.jsx)("main",{className:"max-w-xl mx-auto px-4 py-6",children:"Loading..."})}async function r(){return new Promise(e=>{let n=document.createElement("input");n.type="file",n.accept="image/*",n.onchange=()=>{var a;e((null===(a=n.files)||void 0===a?void 0:a[0])||null)},n.click()})}},7795:function(e,n,a){"use strict";a.d(n,{D:function(){return i}});var t=a(149);async function i(e){let n=(0,t.e)(),{bucket:a,file:i}=e,l=e.path||"".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2),"_").concat(i.name),{error:c}=await n.storage.from(a).upload(l,i);if(c)return null;let{data:o}=n.storage.from(a).getPublicUrl(l);return{publicUrl:o.publicUrl,path:l}}},149:function(e,n,a){"use strict";a.d(n,{e:function(){return l}});var t=a(1388);let i=null;function l(){if(i)return i;let e="https://awjryaofcfuhyofqfixo.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!n)throw Error("Missing Supabase envs");return i=(0,t.createBrowserClient)(e,n,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let n=e.indexOf("=");return{name:n>=0?decodeURIComponent(e.slice(0,n)):e,value:n>=0?decodeURIComponent(e.slice(n+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:n,value:a,options:t}of e){let e="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(a));t&&(t.maxAge&&(e+="; Max-Age=".concat(t.maxAge)),t.expires&&(e+="; Expires=".concat(new Date(t.expires).toUTCString())),t.path&&(e+="; Path=".concat(t.path)),t.domain&&(e+="; Domain=".concat(t.domain)),t.sameSite&&(e+="; SameSite=".concat(t.sameSite)),t.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,3145,2971,2117,1744],function(){return e(e.s=70)}),_N_E=e.O()}]);