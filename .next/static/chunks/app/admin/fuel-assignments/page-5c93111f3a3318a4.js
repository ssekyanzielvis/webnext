(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4377],{3376:function(e,s,a){Promise.resolve().then(a.bind(a,2627))},2627:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return r}});var n=a(7437),t=a(2265),i=a(149);function r(){let e=(0,i.e)(),[s,a]=(0,t.useState)([]),[r,c]=(0,t.useState)([]),[d,l]=(0,t.useState)([]),[o,m]=(0,t.useState)(!0),[u,f]=(0,t.useState)(null),x=(0,t.useCallback)(async()=>{m(!0);let[s,n,t]=await Promise.all([e.from("fuel_card_assignments").select("*").order("assigned_date",{ascending:!1}),e.from("fuel_cards").select("id,card_number").order("card_number"),e.from("users").select("id,full_name,email").eq("role","driver").order("full_name")]);s.error?f(s.error.message):a(s.data),c(n.data||[]),l(t.data||[]),m(!1)},[e]);async function p(){let s=prompt("Fuel Card ID (copy from list below):")||"",a=prompt("Driver ID (copy from list below):")||"";if(!s||!a)return;let{error:n}=await e.from("fuel_card_assignments").insert({fuel_card_id:s,driver_id:a,assigned_by:"admin",assigned_date:new Date().toISOString()});n?f(n.message):x()}async function h(s){let{error:a}=await e.from("fuel_card_assignments").update({unassigned_date:new Date().toISOString()}).eq("id",s);a?f(a.message):x()}return(0,t.useEffect)(()=>{x()},[x]),(0,n.jsxs)("main",{className:"max-w-6xl mx-auto px-4 py-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h1",{className:"text-xl font-bold",children:"Fuel Card Assignments"}),(0,n.jsx)("button",{className:"btn-primary",onClick:p,children:"Assign Card"})]}),u&&(0,n.jsx)("div",{className:"text-sm text-red-600 mb-3",children:u}),o?(0,n.jsx)("div",{children:"Loading..."}):(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"md:col-span-2",children:[(0,n.jsx)("h2",{className:"font-semibold mb-2",children:"Assignments"}),(0,n.jsx)("ul",{className:"space-y-3",children:s.map(e=>(0,n.jsxs)("li",{className:"card p-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"font-semibold",children:["Card: ",e.fuel_card_id]}),(0,n.jsxs)("div",{className:"text-sm text-neutral-600",children:["Driver: ",e.driver_id]}),(0,n.jsxs)("div",{className:"text-xs text-neutral-500",children:["Assigned ",new Date(e.assigned_date).toLocaleString(),e.unassigned_date?" • Unassigned ".concat(new Date(e.unassigned_date).toLocaleString()):""]})]}),!e.unassigned_date&&(0,n.jsx)("button",{className:"px-3 py-1 rounded-md bg-neutral-100",onClick:()=>h(e.id),children:"Unassign"})]},e.id))})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold mb-1",children:"Cards"}),(0,n.jsx)("ul",{className:"text-sm card p-3 max-h-64 overflow-auto",children:r.map(e=>(0,n.jsxs)("li",{children:[e.id," • ",e.card_number]},e.id))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold mb-1",children:"Drivers"}),(0,n.jsx)("ul",{className:"text-sm card p-3 max-h-64 overflow-auto",children:d.map(e=>(0,n.jsxs)("li",{children:[e.id," • ",e.full_name||e.email]},e.id))})]})]})]})]})}},149:function(e,s,a){"use strict";a.d(s,{e:function(){return i}});var n=a(1388);let t=null;function i(){if(t)return t;let e="https://awjryaofcfuhyofqfixo.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!s)throw Error("Missing Supabase envs");return t=(0,n.createBrowserClient)(e,s,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let s=e.indexOf("=");return{name:s>=0?decodeURIComponent(e.slice(0,s)):e,value:s>=0?decodeURIComponent(e.slice(s+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:s,value:a,options:n}of e){let e="".concat(encodeURIComponent(s),"=").concat(encodeURIComponent(a));n&&(n.maxAge&&(e+="; Max-Age=".concat(n.maxAge)),n.expires&&(e+="; Expires=".concat(new Date(n.expires).toUTCString())),n.path&&(e+="; Path=".concat(n.path)),n.domain&&(e+="; Domain=".concat(n.domain)),n.sameSite&&(e+="; SameSite=".concat(n.sameSite)),n.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,2971,2117,1744],function(){return e(e.s=3376)}),_N_E=e.O()}]);