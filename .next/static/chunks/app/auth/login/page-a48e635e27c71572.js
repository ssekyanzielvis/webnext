(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6716],{3950:function(e,t,n){Promise.resolve().then(n.bind(n,6873))},6873:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var a=n(7437),i=n(2265),r=n(149),o=n(7648);function s(){let e=(0,r.e)(),[t,n]=(0,i.useState)(""),[s,l]=(0,i.useState)(""),[u,d]=(0,i.useState)(null),[m,f]=(0,i.useState)(!1);async function p(n){n.preventDefault(),d(null),f(!0);let{data:a,error:i}=await e.auth.signInWithPassword({email:t,password:s});if(i){d(i.message),f(!1);return}await c(e)}return(0,i.useEffect)(()=>{(async()=>{let{data:{user:t}}=await e.auth.getUser();t&&await c(e)})()},[]),(0,a.jsx)("main",{className:"min-h-screen flex items-center justify-center px-4 py-10",children:(0,a.jsxs)("form",{onSubmit:p,className:"card w-full max-w-md p-6 space-y-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Login"}),u&&(0,a.jsx)("div",{className:"text-red-600 text-sm",children:u}),(0,a.jsx)("input",{type:"email",placeholder:"Email",className:"w-full border rounded-md px-3 py-2",value:t,onChange:e=>n(e.target.value),required:!0}),(0,a.jsx)("input",{type:"password",placeholder:"Password",className:"w-full border rounded-md px-3 py-2",value:s,onChange:e=>l(e.target.value),required:!0}),(0,a.jsx)("button",{className:"btn-primary w-full",disabled:m,children:m?"Signing in...":"Sign in"}),(0,a.jsx)("div",{className:"text-sm text-center",children:(0,a.jsx)(o.default,{href:"/auth/register",className:"text-primary",children:"Create account"})})]})})}async function c(e){let{data:t}=await e.auth.getUser(),n=t.user;if(!n)return;let a=null,{data:i}=await e.from("users").select("role").eq("id",n.id).maybeSingle();if((null==i?void 0:i.role)&&(a=i.role),!a){let e=n.user_metadata||{},t=n.app_metadata||{};a=e.role||t.role||"user"}"admin"===a||"other_admin"===a?window.location.href="/admin":"driver"===a?window.location.href="/driver":window.location.href="/client"}},149:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var a=n(1388);let i=null;function r(){if(i)return i;let e="https://awjryaofcfuhyofqfixo.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!t)throw Error("Missing Supabase envs");return i=(0,a.createBrowserClient)(e,t,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let t=e.indexOf("=");return{name:t>=0?decodeURIComponent(e.slice(0,t)):e,value:t>=0?decodeURIComponent(e.slice(t+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:t,value:n,options:a}of e){let e="".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n));a&&(a.maxAge&&(e+="; Max-Age=".concat(a.maxAge)),a.expires&&(e+="; Expires=".concat(new Date(a.expires).toUTCString())),a.path&&(e+="; Path=".concat(a.path)),a.domain&&(e+="; Domain=".concat(a.domain)),a.sameSite&&(e+="; SameSite=".concat(a.sameSite)),a.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return i.a}});var a=n(2972),i=n.n(a)}},function(e){e.O(0,[1388,2972,2971,2117,1744],function(){return e(e.s=3950)}),_N_E=e.O()}]);