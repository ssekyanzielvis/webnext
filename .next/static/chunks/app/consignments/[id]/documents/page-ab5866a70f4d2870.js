(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3464],{2980:function(e,n,t){Promise.resolve().then(t.bind(t,314))},314:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return s}});var c=t(7437),a=t(2265),i=t(149),o=t(7795),l=t(3145);function s(e){let{params:n}=e,t=(0,i.e)(),s=n.id,[r,m]=(0,a.useState)(null),[d,f]=(0,a.useState)(null);async function p(){let e=await u();if(!e)return;let n=await (0,o.D)({bucket:"consignment-docs",file:e,path:"".concat(s,"/").concat(Date.now(),"_").concat(e.name)});if(!n){f("Upload failed");return}let{error:c}=await t.from("consignments").update({document_url:n.publicUrl}).eq("id",s);c?f(c.message):m(n.publicUrl)}async function x(){let{error:e}=await t.from("consignments").update({document_url:null}).eq("id",s);e?f(e.message):m(null)}return(0,a.useEffect)(()=>{(async()=>{let{data:e}=await t.from("consignments").select("document_url").eq("id",s).maybeSingle();m((null==e?void 0:e.document_url)||null)})()},[s,t]),(0,c.jsxs)("main",{className:"max-w-xl mx-auto px-4 py-6",children:[(0,c.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Consignment Documents"}),d&&(0,c.jsx)("div",{className:"text-sm text-red-600 mb-3",children:d}),(0,c.jsx)("div",{className:"card p-4",children:r?(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsx)("div",{className:"relative w-full h-64",children:(0,c.jsx)(l.default,{src:r,alt:"Consignment document",fill:!0,className:"object-contain rounded bg-neutral-50",sizes:"(max-width: 768px) 100vw, 768px"})}),(0,c.jsx)("button",{className:"px-3 py-1 rounded-md bg-neutral-100",onClick:x,children:"Remove"})]}):(0,c.jsx)("button",{className:"btn-primary",onClick:p,children:"Upload Document"})})]})}async function u(){return new Promise(e=>{let n=document.createElement("input");n.type="file",n.accept="image/*",n.onchange=()=>{var t;e((null===(t=n.files)||void 0===t?void 0:t[0])||null)},n.click()})}},7795:function(e,n,t){"use strict";t.d(n,{D:function(){return a}});var c=t(149);async function a(e){let n=(0,c.e)(),{bucket:t,file:a}=e,i=e.path||"".concat(Date.now(),"_").concat(Math.random().toString(36).slice(2),"_").concat(a.name),{error:o}=await n.storage.from(t).upload(i,a);if(o)return null;let{data:l}=n.storage.from(t).getPublicUrl(i);return{publicUrl:l.publicUrl,path:i}}},149:function(e,n,t){"use strict";t.d(n,{e:function(){return i}});var c=t(1388);let a=null;function i(){if(a)return a;let e="https://awjryaofcfuhyofqfixo.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF3anJ5YW9mY2Z1aHlvZnFmaXhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MzA5MjYsImV4cCI6MjA3MzAwNjkyNn0.3ccRaiv7odT4xL6jI0f5dV9BrMnZw8LUeofJZ0ZOo5c";if(!e||!n)throw Error("Missing Supabase envs");return a=(0,c.createBrowserClient)(e,n,{cookies:{getAll:async()=>"undefined"==typeof document?[]:document.cookie.split(";").map(e=>e.trim()).filter(Boolean).map(e=>{let n=e.indexOf("=");return{name:n>=0?decodeURIComponent(e.slice(0,n)):e,value:n>=0?decodeURIComponent(e.slice(n+1)):""}}),setAll:async e=>(function(e){if("undefined"!=typeof document)for(let{name:n,value:t,options:c}of e){let e="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(t));c&&(c.maxAge&&(e+="; Max-Age=".concat(c.maxAge)),c.expires&&(e+="; Expires=".concat(new Date(c.expires).toUTCString())),c.path&&(e+="; Path=".concat(c.path)),c.domain&&(e+="; Domain=".concat(c.domain)),c.sameSite&&(e+="; SameSite=".concat(c.sameSite)),c.secure&&(e+="; Secure")),document.cookie=e}})(e)}})}}},function(e){e.O(0,[1388,3145,2971,2117,1744],function(){return e(e.s=2980)}),_N_E=e.O()}]);